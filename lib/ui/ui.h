#ifndef UI_H
#define UI_H
#include <Adafruit_GFX.h>
#include "weather_sensor.h"
#include "display.h"
#include "tank.h"

#define ICON_SIZE 21

static const unsigned char PROGMEM icon_thermometer[] {
    0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x80, 0x19, 0x00, 0x80, 0x10, 0x00,
    0x80, 0x10, 0x00, 0x80, 0x10, 0x00, 0x80, 0x10, 0x00, 0x80, 0x16, 0x00,
    0x80, 0x16, 0x00, 0x80, 0x16, 0x00, 0x80, 0x16, 0x00, 0x80, 0x16, 0x00,
    0xc0, 0x36, 0x00, 0x60, 0x66, 0x00, 0x20, 0x4f, 0x00, 0x20, 0x4f, 0x00,
    0x60, 0x66, 0x00, 0xc0, 0x30, 0x00, 0x80, 0x19, 0x00, 0x00, 0x0f, 0x00,
    0x00, 0x00, 0x00 };

static const unsigned char PROGMEM icon_humidity[] {
    0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x1b, 0x00,
    0x80, 0x31, 0x00, 0xc0, 0x60, 0x00, 0x60, 0xc0, 0x00, 0x30, 0x80, 0x01,
    0x10, 0x00, 0x01, 0x18, 0x00, 0x03, 0x88, 0x31, 0x02, 0x8c, 0x19, 0x06,
    0x0c, 0x0c, 0x06, 0x0c, 0x06, 0x06, 0x0c, 0x33, 0x06, 0x88, 0x31, 0x02,
    0x18, 0x00, 0x03, 0x30, 0x80, 0x01, 0x60, 0xc0, 0x00, 0xc0, 0x71, 0x00,
    0x00, 0x1f, 0x00 };

enum class Screen {
    GRAY_TANK,
    FRESH_TANK,
    WEATHER,
    WARNING,
    IDLE
};

class Ui {
    public: 
        Ui(Display& _display);
        void begin();
        void printIdle();
        void printGrayTank(int level);
        void printFreshTank(int level);
        void printWeather(weather_t indoor, weather_t outdoor); 
        void printWarnings(TankStatus fresh_status, TankStatus gray_status, bool ext_freezing, bool int_freezing);
        void nextScreen();
        void showGrayTank();
        void showFreshTank();
        void showWeather();
        void showWarnings();
        void showIdle();
        bool isShowingIdle() { return current_screen == Screen::IDLE; }
        Screen getCurrentScreen() { return current_screen; };

    private:
        Display& display;
        Screen current_screen = Screen::WEATHER;
        void printLevel(int level);
        void printWeatherTemplate();
        void printZoneTemperature(weather_t* zone, int x);
};

#endif
